{
    "createDate": "2022-07-20T19:19:41.164Z",
    "modifiedDate": "2022-08-02T08:22:45.361Z",
    "isRemote": false,
    "favorites": 1,
    "_id": "62d8554d8cd87e0015976b45",
    "parameters": {
        "concurrentUsers": 2
    },
    "sessionSize": 2,
    "testProfiles": [
        {
            "browser": "linux-chrome-stable",
            "location": "East-US",
            "network": "No throttling",
            "firewall": "FW_NO_FW",
            "media": "KrankyGeek-2-1080p.mp4"
        }
    ],
    "name": "Daily 1-1 Mesh SFU Self-Serve",
    "testScript": "const agentName = process.env.RTC_AGENT_NAME;\nconst agentType = Number(process.env.RTC_IN_SESSION_ID);\nconst agentSessionName = process.env.RTC_SESSION_NAME;\nconst agentNumber = process.env.RTC_AGENT_NUM;\nconst sec = 1000;\nconst baseURL = process.env.RTC_SERVICE_URL;\n\nif (agentType === 1) {\n    console.log(\"creating room\", agentName)\n    createAndJoinRoom();\n    return;\n}\nconsole.log(\"waiting for room URL\", agentName)\nclient\n    .rtcWaitForSessionValue('roomURL', function(url) {\n        console.log(\"joining room\", agentType, agentName, url)\n        joinRoom(agentName, url);\n    }, 30 * sec);\n\n\nfunction createAndJoinRoom(agentName) {\n    setExpectations();\n    const url = `${baseURL}?roomParams={\"enable_mesh_sfu\":true}`\n    client\n        .rtcInfo(\"testRTC agent start - agent: %s\", agentName)\n        .pause((500 * agentType) + 10)\n        .rtcProgress(\"Creating call \" + url)\n        .url(url)\n        .waitForElementVisible('#inCall', 120 * sec)\n        .rtcProgress(\"Broadcasting room URL to other agents\")\n        .getText('#inCall', function(result) {\n            // Remove whitespace\n            const roomURL = result.value.replace(/\\s+/g, '');\n            client.rtcInfo('Sending Room url %s', roomURL)\n                .rtcProgress(\"Waiting @ \" + roomURL)\n                .rtcSetSessionValue(\"roomURL\", roomURL);\n        })\n        .pause(5000)\n        .rtcProgress(\"Starting to test \" + url)\n        // Give some time to collect media stats\n        .pause(60 * sec)\n        .rtcScreenshot('mid-call')\n        .pause(60 * sec)\n        .rtcProgress(\"done!\");\n}\n\nfunction joinRoom(agentName, roomURL) {\n    setExpectations();\n    const url = `${baseURL}?roomURL=${roomURL}`\n    client\n        .rtcInfo(\"testRTC agent start - agent: %s room: %s\", agentName, roomURL)\n        .pause((500 * agentType) + 10)\n        .rtcProgress(\"Joining \" + url)\n        .url(url)\n        .waitForElementVisible('#inCall', 120 * sec)\n        .pause(5000)\n        .rtcProgress(\"In \" + url)\n\n        // Give some time to collect media stats\n        .pause(60 * sec)\n        .rtcScreenshot('mid-call')\n        .pause(60 * sec)\n        .rtcProgress(\"done!\");\n}\n\nfunction setExpectations() {\n    client\n        .rtcSetTestExpectation(\"audio.in >= 1\")\n        .rtcSetTestExpectation(\"audio.out >= 1\")\n        .rtcSetTestExpectation(\"video.in >= 1\")\n        .rtcSetTestExpectation(\"video.out >= 1\")\n        .rtcSetTestExpectation(\"audio.in.bitrate > 0\")\n        .rtcSetTestExpectation(\"audio.out.bitrate > 0\")\n        .rtcSetTestExpectation(\"video.in.bitrate > 0\")\n        .rtcSetTestExpectation(\"video.out.bitrate > 0\")\n        .rtcIgnoreErrorContains(\"AudioContext was not allowed to start\");\n}",
    "webhook": "",
    "def_sort": "daily 1-1 mesh sfu self-serve",
    "project": "62a34676d012d90013b90582",
    "__v": 0,
    "lastRunDate": "2022-08-02T08:22:45.349Z",
    "lastRunStatus": "completed",
    "runCount": 3,
    "info": "Tests having two sessions join a Daily Prebuilt Mesh SFU call using a self-serve deployment of Daily TestRTC Client",
    "lastRank": null,
    "lastRankDelta": null,
    "stared": false,
    "serviceUrl": "https://daily-testrtc.netlify.app/",
    "numberOfSessions": 1
}